var _ref,__bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(d,b){for(var a in b){if(__hasProp.call(b,a)){d[a]=b[a]}}function c(){this.constructor=d}c.prototype=b.prototype;d.prototype=new c();d.__super__=b.prototype;return d};Annotator.Plugin.RichText=(function(a){__extends(b,a);b.prototype.options={tinymce:{selector:"li.annotator-item textarea",plugins:"media image insertdatetime link",toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image media ",}};function b(d,c){_ref=b.__super__.constructor.apply(this,arguments);return _ref}b.prototype.pluginInit=function(){console.log("RichText-pluginInit");var d=this.annotator,c=this.annotator.editor;if(!Annotator.supported()){return}d.editor.addField({type:"input",load:this.updateEditor,});d.viewer.addField({load:this.updateViewer,});d.subscribe("annotationEditorShown",function(){$(d.editor.element).find(".mce-tinymce")[0].style.display="block";$(d.editor.element).find(".mce-container").css("z-index",3000000000)});d.subscribe("annotationEditorHidden",function(){$(d.editor.element).find(".mce-tinymce")[0].style.display="none"});this.options.tinymce.setup=function(e){e.on("change",function(f){$(c.element).find("textarea")[0].value=f.level.content});e.on("Init",function(f){$(".mce-container").css("z-index","3090000000000000000")})};tinymce.init(this.options.tinymce)};b.prototype.updateEditor=function(d,c){var e=typeof c.text!="undefined"?c.text:"";tinymce.activeEditor.setContent(e);$(d).remove()};b.prototype.updateViewer=function(e,c){var d=$(e.parentNode).find("div:first-of-type")[0];d.innerHTML=c.text;$(d).addClass("richText-annotation");$(e).remove()};return b})(Annotator.Plugin);