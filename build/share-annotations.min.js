var _ref,__bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(d,b){for(var a in b){if(__hasProp.call(b,a)){d[a]=b[a]}}function c(){this.constructor=d}c.prototype=b.prototype;d.prototype=new c();d.__super__=b.prototype;return d};Annotator.Plugin.Share=(function(b){__extends(a,b);function a(){this.updateField=__bind(this.updateField,this);_ref=a.__super__.constructor.apply(this,arguments);return _ref}a.prototype.field=null;a.prototype.input=null;a.prototype.pluginInit=function(){console.log("Share-pluginInit");if(!Annotator.supported()){return}this.field=this.annotator.editor.addField({type:"input",load:this.updateField,});var f='<div class="share-text-annotator">Share without saving:</div>',e='<div class="share-facebook-annotator button"></div>',j='<div class="share-twitter-annotator button"></div>',d='<div class="share-google-annotator button"></div>',h='<div class="share-email-annotator button"></div>',i=e+j+d+h,c='<li class="annotator-item"><div class="share-container-annotator">'+f+i+"</div></li>",g=Annotator.$(c);Annotator.$(this.field).replaceWith(g);this.field=g[0];this.buttonsActions();return this.input=$(this.field).find(":input")};a.prototype.buttonsActions=function(){var c=this;$(this.field).find(".share-email-annotator").click(function(){var d=c.createAPIURL(2),e="Sharing a annotation with Open Video Annotation";body=encodeURIComponent(d);window.open("mailto:?subject="+e+"&body="+body)});$(this.field).find(".share-facebook-annotator").click(function(){var d=c.createAPIURL(2),e="https://www.facebook.com/sharer/sharer.php?s=100&p[url]="+encodeURIComponent(d)+"&p[title]="+encodeURIComponent("Open Video Annotation")+"&p[summary]="+c.getSource("ovaText");window.open(e)});$(this.field).find(".share-twitter-annotator").click(function(){var e=c.createAPIURL(2),d="https://twitter.com/intent/tweet?original_referer="+encodeURIComponent(e)+"&source=tweetbutton&url="+encodeURIComponent(e)+"&via=OpenVideoAnnotation&text="+encodeURIComponent("I want to share the next Open Video Annotation: ");window.open(d)});$(this.field).find(".share-google-annotator").click(function(){var d=c.createAPIURL(2),e="https://plus.google.com/share?url="+encodeURIComponent(d);window.open(e)})};a.prototype.createAPIURL=function(i){var i=i||1,c=location.protocol+"//"+location.host+location.pathname,c="http://danielcebrian.com/annotations/demo.html";if(i===1){}else{if(i===2){var g=this.getSource("ovaContainer"),f=this.getSource("ovaSrc"),d=this.getSource("ovaStart"),h=this.getSource("ovaEnd"),e=this.getSource("ovaText");c+="?ovaContainer="+g+"&ovaSrc="+f+"&ovaStart="+d+"&ovaEnd="+h+"&ovaText="+e}}return c};a.prototype.getSource=function(e){var f=this.annotator,d=f.editor,c=$(d.element).find("textarea")[0],e=e||"";if(e=="ovaContainer"){e=d.VideoJS!==-1?d.VideoJS:f.wrapper.parent()}else{if(e=="ovaSrc"){e=d.VideoJS!==-1?f.mplayer[d.VideoJS].tag.currentSrc:""}else{if(e=="ovaStart"){e=d.VideoJS!==-1?f.mplayer[d.VideoJS].rangeslider.getValues().start:""}else{if(e=="ovaEnd"){e=d.VideoJS!==-1?f.mplayer[d.VideoJS].rangeslider.getValues().end:""}else{if(e=="ovaText"){e=c.value}}}}}return encodeURIComponent(e)};a.prototype.getSrc=function(){var e=this.annotator,d=e.editor,c=d.VideoJS!==-1?e.mplayer[d.VideoJS].tag.currentSrc:"";return encodeURIComponent(c)};a.prototype.updateField=function(d,c){};return a})(Annotator.Plugin);